/* ============================================================
   MODULE 08: ORIGIN (V14.0)
   超創造的な由来生成
   ============================================================ */

/**
 * 由来文の生成
 */
function generateOrigin() {
    const modal = document.getElementById('modal-origin');
    if (!modal) return;
    
    const textEl = modal.querySelector('p');
    if (!textEl) return;
    
    textEl.innerText = '由来を生成中...';
    modal.classList.add('active');
    
    const combo = currentBuildResult.combination;
    if (!combo || combo.length === 0) {
        textEl.innerText = '名前データが見つかりません';
        return;
    }
    
    setTimeout(() => {
        const originText = buildCreativeOrigin(combo);
        textEl.innerText = originText;
    }, 800);
}

function buildCreativeOrigin(combo) {
    const patterns = [
        p1, p2, p3, p4, p5, p6, p7, p8, p9, p10, p11, p12, p13, p14, p15
    ];
    return patterns[Math.floor(Math.random() * patterns.length)](combo);
}

function p1(c) {
    const k = c.map(x => x['漢字']).join('');
    const m = c.map(x => clean(x['意味']).split(/[。、]/)[0]);
    return `この名前を考えたのは、ある静かな夜のことでした。\n\n窓の外を見つめながら、この子がどんな人生を歩んでいくのだろうと想像していました。そのとき、ふと心に浮かんだのが「${m[0]}」という言葉。${m[1] ? `そして「${m[1]}」。` : ''}${m[2] ? `さらに「${m[2]}」。` : ''}\n\nこれらの言葉が自然と結びつき、「${k}」という名前が生まれました。\n\n${wish()}`;
}

function p2(c) {
    const k = c.map(x => x['漢字']).join('');
    return `「${k}」\n\nこの名前には、大切な思い出が込められています。\n\n${c.length}つの漢字それぞれに、あなたへの願いを託しました。\n\n人生という長い旅路で、この名前があなたの道標となり、支えとなりますように。`;
}

function p3(c) {
    const k = c.map(x => x['漢字']).join('');
    const s = c.map(x => parseInt(x['画数']) || 0).reduce((a,b) => a+b, 0);
    return `名前を決めるまでに、たくさんの候補を考えました。\n\n${s}画で構成される「${k}」。一画一画に想いを込めて、この文字を選びました。\n\n${c.map((x, i) => `${i+1}文字目の「${x['漢字']}」は、${clean(x['意味']).split(/[。、]/)[0]}を表しています。`).join('\n')}\n\n${wish()}`;
}

function p4(c) {
    const k = c.map(x => x['漢字']).join('');
    return `命名の日、家族みんなで集まって、この名前について語り合いました。\n\n「${k}」という響き。声に出して呼んでみると、とても温かく、優しい音が部屋に響きました。\n\nこの名前を呼ぶたび、あなたの笑顔を思い浮かべるでしょう。そして、あなたがこの名前を誇りに思ってくれることを願っています。`;
}

function p5(c) {
    const k = c.map(x => x['漢字']).join('');
    const m = c.map(x => clean(x['意味']).split(/[。、]/)[0]);
    return `「${k}」という名前は、偶然ではなく、必然として生まれました。\n\n${m.map((x, i) => `${i === 0 ? 'まず' : i === m.length - 1 ? 'そして' : 'さらに'}、「${x}」という言葉に心を動かされました。`).join(' ')}\n\nこれらが重なり合い、唯一無二の名前が完成しました。\n\nこの名前とともに、あなたらしい素晴らしい人生を歩んでいってください。`;
}

function p6(c) {
    const k = c.map(x => x['漢字']).join('');
    return `${k}\n\n一文字ずつ、丁寧に選び抜いた漢字。\n\nまっすぐに、のびのびと。\n優しく、強く。\n\nこの名前に込めたのは、ただ一つ。\n\nあなたが、あなたらしく輝いてほしいという願いです。`;
}

function p7(c) {
    const k = c.map(x => x['漢字']).join('');
    return `「${k}」\n\n声に出して呼ぶと、\n心が温かくなる名前。\n\n文字を見つめると、\n未来が明るく感じる名前。\n\nこの名前とともに、\nあなたの人生が、\n喜びと幸せに満ちたものになりますように。`;
}

function p8(c) {
    const k = c.map(x => x['漢字']).join('');
    return `あなたが生まれる前から、この名前は心の中にありました。\n\n何冊もの本を読み、何百もの名前を書き出し、声に出して読んでみました。そして最後に残ったのが「${k}」でした。\n\n不思議なことに、この名前を見た瞬間、「これだ」と確信しました。まるで、この名前があなたを待っていたかのように。`;
}

function p9(c) {
    const k = c.map(x => x['漢字']).join('');
    const m = c.map(x => clean(x['意味']).split(/[。、]/)[0]);
    return `命名ノートには、たくさんの候補が書かれています。\n\nその中で、「${k}」だけに丸印がついています。${m.length > 0 ? `\n\n「${m[0]}」${m[1] ? `、「${m[1]}」` : ''}${m[2] ? `、「${m[2]}」` : ''}——これらの意味が、不思議なほどぴったりと重なり合いました。` : ''}\n\nこの名前を選んだ理由を、いつかあなたに話せる日を楽しみにしています。`;
}

function p10(c) {
    const k = c.map(x => x['漢字']).join('');
    return `名前とは、その人の人生を表す最初の言葉です。\n\n「${k}」という名前には、あなたがどんな人になってほしいか、どんな人生を歩んでほしいかという、すべての願いが詰まっています。\n\n名前は、一生変わらないもの。だからこそ、心を込めて選びました。`;
}

function p11(c) {
    const k = c.map(x => x['漢字']).join('');
    return `人は名前によって呼ばれることで、自分という存在を認識します。\n\n「${k}」——この名前を呼ぶたび、あなたの存在がより鮮明に、より特別なものとして感じられるでしょう。\n\n名前は単なる記号ではありません。それは、あなたという唯一無二の存在を表す、かけがえのない言葉なのです。`;
}

function p12(c) {
    const k = c.map(x => x['漢字']).join('');
    return `自然の中には、たくさんの美しさと強さがあります。\n\n「${k}」という名前を選んだのは、自然体で、しなやかに生きてほしいと思ったからです。\n\n大きな木が年輪を重ねるように、あなたも一日一日を大切に積み重ねていってください。`;
}

function p13(c) {
    const k = c.map(x => x['漢字']).join('');
    return `四季それぞれに美しさがあるように、人生にもさまざまな季節があります。\n\n「${k}」という名前には、どんな季節も、あなたらしく輝いてほしいという願いを込めました。\n\n春の訪れを喜び、夏の日差しを浴び、秋の実りに感謝し、冬の静けさに心を整える。\n\nそんな豊かな人生を歩んでください。`;
}

function p14(c) {
    const k = c.map(x => x['漢字']).join('');
    const m = c.map(x => clean(x['意味']).split(/[。、]/)[0]);
    return `親から子への最初の贈り物——それが名前です。\n\n「${k}」という名前に込めた願いは、とてもシンプルです。\n\n${m.map(x => `${x}のように、`).join('')}心豊かに、幸せに生きてほしい。\n\nただそれだけです。でも、それが一番大切な願いなのです。`;
}

function p15(c) {
    const k = c.map(x => x['漢字']).join('');
    return `「${k}」\n\nこの名前は、あなたが一生持ち続ける、かけがえのない財産です。\n\n何十年後、あなたが誰かに自分の名前を紹介するとき、誇りを持って語れる名前であってほしい。そう願って選びました。\n\n名前の由来を聞かれたら、こう答えてください。\n\n「親が、心を込めて選んでくれた名前です」と。`;
}

function wish() {
    const w = gender === 'male' ? [
        '誠実で、周りの人から信頼される人になってほしい。',
        '困難に立ち向かう勇気と、優しさを持った人になってほしい。',
        '自分の道を堂々と歩み、人生を切り拓いていってほしい。'
    ] : gender === 'female' ? [
        '優しさと強さを兼ね備えた、素敵な人になってほしい。',
        '自分らしく輝き、周りの人を笑顔にできる人になってほしい。',
        'しなやかで芯の強い、美しい心を持った人になってほしい。'
    ] : [
        '自分らしく、のびのびと成長してほしい。',
        '心豊かに、幸せな人生を歩んでほしい。',
        '周りの人を大切にし、大切にされる人になってほしい。'
    ];
    return w[Math.floor(Math.random() * w.length)];
}

console.log("ORIGIN: Module loaded");
